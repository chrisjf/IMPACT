********************************************
*  Read me for the IMPACT ART source code  *
********************************************

******************
   General info   
******************
Below a description of all relevant folders and files within the /art/ folder. 
This folder contains the entire application:

config/  Contains a .js file and a .php file with configuration details of the 
         ART, such as the root of the current server at which the API calls 
         should be directed and the database connection details.
css/     Contains CSS styles. art.css is our own CSS. All other .css-files were 
         taken from the toolbox, and not adapted in any way.  They are only 
         here in order to make the stand-alone version look and work the same 
         way it does inside the toolbox. 
img/     Contains ART-specific images.
js/      Folder containing all JavaScript code. Configuration of 
         JavaScript-specifc things are done in /config, so you should not have 
         to alter any of the code in this folder.
log/     Log files are placed in this folder. It can be emptied at any time 
         without a problem as the application does not read anything from this 
         folder.
php/     This folder contains all PHP code. Configuration of JavaScript-specifc 
         things are done in /config, so you should not have to alter any of the 
         code in this folder. This folder also contains the relations.xml file 
         that contains a representation of the argument schemes and other 
         relations.
         with the database dump.
test/    Folder containing unit testing code. Does not contain any relevant 
         code to let the ART function.
www/     Folder containing code to let the ART run stand-alone. For integration 
         in the toolbox, contents of this folder are irrelevant.  The 
         stand-aline version of the ART can be called by browsing to 
         www/index.php. (One could say that the index.php file serves as a 
         surrogate toolbox that provides things like the general HTML structure 
         with a <div id='art'> in it, and the function that calls the ART 
         init() function.)

We also describe a few files in the www/ folder:
impact_UoL_UvA_DB_vX_X.sql  (The X's are the version numbers). Complete 
                            database dumps including example data for different 
                            versions of the database.
resetdb1.php                HTML page asking whether you want to reset the DB.
resetdb2.php                PHP code that dumps the entire DB, crates it again 
                            and fills it with the contents of the DB dump file. 
                            Redirects back to the start screen of the ART.
resetqueries.sql            MySQL queries for erasing and recreating the 
                            database (used by the reset-scripts)
jquery[***].js              A number of JQuery files only used in the 
                            stand-alone version. The IMPACT toolbox has it's 
                            own JQuery files.

An online version (that might not be up-to-date) can be viewed at:
http://justinian.leibnizcenter.org/impact/
On this page you can also find a link to the JavaScript and PHP documentation 
generated by JSDoc and Doxygen respectively. (All information there is taken 
directly from our source code comments.)

A lot more documentation on the entire ART can be found in our deliverable D3.2 
and in the documents that describe information exchange between the tools 
TR2.3a and TR2.3b.

******************************
   Installation instruction   
******************************
The ART should be able to run on any (relatively up-to-date) PHP5 installation 
without special settings or installations. We use MySQL 5.5 and we are using 
the InnoDB storage engine (because of the foreign key functionality). The 
JavaScript code is supposed to be able to run flawlessly in any modern browser 
for a normal computer (i.e. we did not test anything for mobile devices), 
  though we must add that the tool was not tested in Internet Explorer yet.

For installation of the stand-alone version, the following steps should be 
performed:
1.  Run the MySQL database dump stored in the file impact_UoL_UvA_DB_v1_4.sql 
    (or a higher version number than 1_4). This is the database currently used 
    for the ART and SCT.
2.  Alter the files in the config/ folder to represent your local server and 
    database settings.
3.  If you want to use the reset script, PHP should be configured to have 
    access to the command line, and you should set the path to the mysql 
    installation in resetdb2.php.
4.  Open a web browser and surf to art/www/index.html. You should see a 
    functioning toolbox.

Tip
Watch out for the log files not to get too big. Because they contain entire 
stack traces with objects spelled out in them, they tend to grow to dozens of 
megabytes quickly. You can empty the log/ directory at any time.

*********************
  Questions/remarks
*********************
For any questions or remarks, send an e-mail to Jochem Douw, j.v.douw@uva.nl.

**************
  Known bugs
**************
A list of known bugs at this time:
- When selecting the very beginning of a document and clicking the "paste" 
  button, the quote is not saved.

************
  Versions
************

Version 2.0 - 11 Oct 2012  
First officially numbered version.

Version 2.1 - 16 Oct 2012
- Repaired errors for GETting issues (export to AVT)
- Made more API requests be handled without api_handlers.php
- Altered the data of the 1_4 version of the database: there were some smart 
  quotes that got crippled by character set switching somehow. I removed the 
  text at the end of the MediaSet reply that did not belong there. Changed the 
  relations - discussions table to reflect that the ACS schemes are now 
  numbered 10 through 18 in stead of 1 through 9.
- Added new scheme Value Credible Source Argument Scheme
- The names of the argument schemes now come from the XML file (or actually 
  it's JSON surrogate), in stead of a hard-coded version.
- Added new "quote" text at relation elements, representing the literal quote 
  of the text even when the text is changed by the user (not yet fully 
  functional).

Version 2.2 - 13 Nov 2012
- Put in quote text directly when clicking "Paste" (quote fully functional)
- When start quote is greater than end quote, they are swapped before saving 
  (on the sever-side)
- Removed redundant file views/ArgumentRender.js
- Removed original large info-picture, added link to location and info about 
  legal aspects in img/picture-licences.txt
- Made a script (in php/xml2json.php) to be able to quickly update the JSON 
  representation of the arguments in the RelationReader based on the XML file. 
  The script is auxilariy, and not loaded when the ART is used.
- When arity of a relation is n (e.g. there are several circumstances), they 
  are actually being displayed.
- Changed the XML file a bit: added labels to a few relation elements.
- For each element of a relation, the 'label' tag is used for displaying the 
  relation as defined in the XML file.
- In the breadcrumbs of the form that indicate the relation and it's elements, 
  the "rel" was replaced by the appropriate type and ID. Actually, the standard 
  breadcrumb structure (see D3.2) is now used in the id attribute of the 
  fieldset tags, and as part of the the name attributes of the input tags etc.
- Refactoring: moved functions fetchRelations and fetchIssue from Storage to 
  the Discussion object. (eventually, Storage should not be used anymore).
- Rewrote the callback function for submitting the relations. This was 
  necessary because of the changed HTML structure of the forms. Added plus and 
  minus buttons in the add and edit forms for adapting conjunctions. Choosing 
  existing elements is not yet possible. When several conjuncts are present, 
  they are all being put into the JSON output (i.e. the PUT HTTP-request) as 
  well.
- We also added server-side support for updating conjunctions: removal, 
  updating and adding new conjuncts work.
- Every occurrence of the word "discussion" is replaced by "issue" in the UI, 
  in order to adhere to the AVT naming convention. In all code and all logs, 
  only the word "discussion" is used, exactly as before.
- When adding a relation, you end up at the edit screen for that same relation.
- When adding or updating a relation, a message is shown that the relation has 
  been saved.
- All such confirmation messages disappear after a 7 second delay (numer of 
  seconds can be changed easily at one central spot)

Version 2.2.1 - 14 Nov 2012
- Bug resolved that caused the entire application to stop at a user notice when 
  errors were not being displayed.

Version 2.2.2 - 19 Nov 2012
- A welcome text is displayed at the right side of the tool, in stead of "No 
  document selected."
- Solved a problem with a mysql_connect_error call that was given an argument 
  (though it's not allowed to have one)
- Changed a few things related to null values and storage in the UID MySQL 
  database, that somehow demands stricter typing than on our other systems.
- Solved a number of other bugs that only appeared in Quercus.

Version 3.0 - 22 Nov 2012
- Added possibility to choose existing elements with button "Choose existing".
- Added/updated a few help texts.
- Added the new "general" argument scheme, consisting of a random number of 
  premises and a conclusion. (Because of that, also updated database dump, 
  version 1_5 was introduced.)
 
Version 3.0.1 - 23 Nov 2012
- Updated a few help texts.
